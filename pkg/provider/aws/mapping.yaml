
# expect a field named "Tags" which contains a slice of struct{Key, Value}
tagField:
  name: Tags
  key: Key
  value: Value

mappings:
  # the Go type that is returned by the cloud provider
  - type: "github.com/aws/aws-sdk-go-v2/service/ec2/types.Instance"
    # the resource type as displayed by cloudgrep
    resourceType: "ec2.Instance"
    # the name of the id field
    idField: InstanceId
    # the method to call to fetch the resources, it must be implemented
    impl: FetchEC2Instances
  - type: "github.com/aws/aws-sdk-go-v2/service/elasticloadbalancingv2/types.LoadBalancer"
    resourceType: "elb.LoadBalancer"
    idField: LoadBalancerArn
    impl: FetchLoadBalancers
    tagImpl: FetchLoadBalancerTag
  - type: "github.com/aws/aws-sdk-go-v2/service/s3/types.Bucket"
    resourceType: "s3.Bucket"
    idField: Name
    impl: FetchS3Buckets
    tagImpl: FetchS3BucketsTag
  - type: "github.com/aws/aws-sdk-go-v2/service/ec2/types.Volume"
    resourceType: "ec2.Volume"
    idField: VolumeId
    impl: FetchEBSVolumes
  - type: "github.com/aws/aws-sdk-go-v2/service/lambda/types.FunctionConfiguration"
    resourceType: "lambda.Function"
    idField: FunctionArn
    impl: FetchLambdas
    tagImpl: FetchFunctionTag
